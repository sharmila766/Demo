<!DOCTYPE html>
<html>
   <head>
      <title>Bunkering Digi solutions</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <!-- Bootstrap -->
      <link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet">
      <!-- styles -->
      <link href="../../css/stats.css" rel="stylesheet">
      <link href="../../css/styles.css" rel="stylesheet">
      <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
      <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
      <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
      <![endif]-->
      <style>.error{ color: red; font-size: 12px;}</style>
   </head>
   <body>
      <div class="header">
         <div class="col-md-12 top-header">
            <div class="col-md-2">
               <div class="logo">
                  <h1><img src="../../images/logo.png"></h1>
               </div>
            </div>
            <div class="col-md-6">
               <div class="headername">
                  <h2>Digi Bunker Solutions</h2>
               </div>
            </div>
            <div class="col-md-4"></div>
         </div>
      </div>
      <div class="strip">
         <h3> You have selected <span id="subname"></span> plan, please fill and complete your subscription </h3>
      </div>
      <div class="container" style="padding-left: 0px; padding-right: 15px;">
         <div class="panel">
            <div class="panel-body">
               <form name="basicform" id="basicform" method="post" action="yourpage.html">
                  <div id="sf1" class="frm">
                     <div class="container">
                        <div class="step1">
                           <h3>User Information</h3>
                        </div>
                        <hr>
                        <div class="col-md-12" >
                           <div class="col-sm-4 col-md-4"> </div>
                           <div class="col-xs-12  col-md-4">
                              <div class="row filling">
                                 <div class="form-group">
                                    <select class="form-control" id="organizationType" name="organizationType" required>
                                       <option value="">Company Type</option>
                                       <option value="1">Shipping</option>
                                       <option value="2">Bunkering</option>
                                       <option value="3">Testing Lab</option>
                                       <option value="4">Insurance</option>
                                    </select>
                                 </div>
                              </div>
                              <div class="row filling">
                                 <div class="form-group">
                                    <input type="text" class="form-control" placeholder="Username" id="userName" name="userName" required>
                                 </div>
                              </div>
                              <div class="row filling">
                                 <div class="form-group">
                                    <input type="email" class="form-control" placeholder="Email ID" id="emailId" name="emailId" required>
                                 </div>
                              </div>
                              <div class="row filling">
                                 <div class="form-group">
                                    <input type="password" class="form-control" placeholder="Password" id="password" name="password" required>
                                 </div>
                              </div>
                              <div class="row filling">
                                 <div class="form-group">
                                    <input type="password" class="form-control" placeholder="Confirm Password" id="cpassword" name="cpassword" required>
                                 </div>
                              </div>
                              <div class="form-group text-right">
                                 <div class="col-lg-10 col-lg-offset-2">
                                    <button class="btn btn-primary open1" type="button">Click to Proceed <span class="fa fa-arrow-right"></span></button> 
                                 </div>
                              </div>
                           </div>
                           <div class="col-md-4"> </div>
                        </div>
                     </div>
                  </div>
                  <div id="sf2" class="frm" style="display: none;">
                     <div class="container">
                        <div class="step1">
                           <h3>Company Information</h3>
                        </div>
                        <div class="col-md-12">
                           <div id="fmsg" class="alert alert-danger hidden"></div>
                           <div id="smsg" class="alert alert-success hidden">
                           </div>
                           <div class="col-md-4">
                              <div class="form-group step2">
                                 <input type="text" class="form-control" placeholder="Organization Name" id="organizationName" name="organizationName" required>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="form-group step2">
                                 <input type="text" class="form-control" placeholder="Location" name="location" id="location" required>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="form-group step2">
                                 <input type="text" class="form-control" placeholder="IMO No." name="imoNo" id="imoNo" required>
                              </div>
                           </div>
                        </div>
                        <div class="col-md-12">
                           <div class="col-md-4">
                              <div class="form-group step2">
                                 <input type="text" class="form-control port_name" placeholder="Port Name" id="portName" name="portName" data-provide="typeahead" required>
                                 <input type="hidden" name="portId" id="portId">
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="form-group step2">
                                 <input type="text" class="form-control" placeholder="Address Line 1" name="addressLine1" id="addressLine1" required>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="form-group step2">
                                 <input type="text" class="form-control" placeholder="Address Line 2" id="addressLine2" name="addressLine2" required>
                              </div>
                           </div>
                        </div>
                        <div class="col-md-12">
                           <div class="col-md-4">
                              <div class="form-group step2">
                                 <input type="text" class="form-control" placeholder="City" name="city" id="city" required>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="form-group step2">
                                 <input type="text" class="form-control" placeholder="State" id="state" name="state" required>
                              </div>
                           </div>
                           <div class="col-md-4 ">
                              <div class="form-group step2">
                                 <input type="text" class="form-control" placeholder="Country" name="country" id="country" required>
                              </div>
                           </div>
                        </div>
                        <div class="col-md-12">
                           <div class="col-md-4">
                              <div class="form-group step2">
                                 <input type="text" class="form-control" placeholder="Pincode" name="pincode" id="pincode" required>
                              </div>
                           </div>
                           <div class="col-md-4">&nbsp;</div>
                           <div class="col-md-4">&nbsp;</div>
                        </div>
                        <div class="col-md-12 mt-15">
                           <div class="col-md-12">
                              <div class="form-group">
                                 <textarea class="form-control" rows="5" >Terms and Conditions agreements act as a legal contract between you (the company) who has the website or mobile app and the user who access your website and mobile app.Having a Terms and Conditions agreement is completely optional. No laws require you to have one.Not even the super-strict and wide-reaching General Data Protection Regulation (GDPR).Itâ€™s up to you to set the rules and guidelines that the user must agree to.You can think of your Terms and Conditions agreement as the legal agreement where you maintain your rights to exclude users from your app in the event that they abuse your app, where you maintain your legal rights against potential app abusers, and so on.Terms and Conditions are also known as Terms of Service or Terms of Use.</textarea>
                              </div>
                           </div>
                           <div class="col-md-12">
                              <div class="checkbox">
                                 <label>
                                 <input type="checkbox" name="agree" id="agree" value="yes" required>I Agree
                                 </label>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="clearfix" style="height: 10px;clear: both;"></div>
                     <div class="col-md-12 text-right">
                        <button class="btn btn-warning back2" type="button"><span class="fa fa-arrow-left"></span> Back</button> 
                        <input type="hidden" name="subscriptionId" id="subscriptionId" value="">
                        <button class="btn btn-primary open2" type="button">Submit </button> 
                        <img src="../../images/spinner.gif" alt="" id="loader" style="display: none">
                     </div>
                  </div>
               </form>
            </div>
         </div>
      </div>
      <div class="col-md-12 col-xs-12 col-sm-12 footer">
         <p>Copyright: AstraQuark Digi solutions Pvt. Ltd</p>
      </div>
   </body>
   <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
   <script src="https://code.jquery.com/jquery.js"></script>
   <script src="../../js/jquery.validate.js"></script>
   <script src="../../bootstrap/js/bootstrap.min.js"></script>
   <script src="../../js/jquery.session.js"></script>
   <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-3-typeahead/4.0.2/bootstrap3-typeahead.min.js"></script>

    <script type="text/javascript">
       // http://localhost:3000/api/getAllPort
        var port_name_data = [];
        var port_id_data = [];
         $(document).ready(function () {
          
         var allport_url='/api/getAllPort';  
        
            $.ajax({
                                 type: 'POST',
                                 url: allport_url,
                                 dataType:"json",
                                 success: getPortList,
                         });
                         return false;
                         function getPortList(result) {                   
                             if(result.status=="Success") 
                             {
                             // console.log(result.data);
                                     $.each(result.data, function( key, value ) { 
                                    //  console.log(result.data);
                                          port_name_data.push(value.portName);
                                          port_id_data.push(value._id+':'+value.portName); 
                                                                        
                                                                 
                                     });                     
                                     
                             }
                            // console.log(port_name_data);
                                            
         
              }
    });
$(document).ready(function () { 
 
               var $port_name = $(".port_name");
                $port_name.typeahead({
                source: port_name_data,
                autoSelect: true
              });
                

                 $('#portName').change(function(){
                var port_name= $(this).val();
                     $.each(port_id_data, function( key, value ) { 
                     var pname=value.split(':');
                         if(pname[1] == port_name)
                         {
                             $('#portId').val(pname[0]);
                         }  
                     });
                           
             })


        });

             
      
    </script>
   <script>
      var subid=$.session.get("subid");
      $('#subscriptionId').val(subid);
      var subname=$.session.get("subname");
      $('#subname').text(subname);
      
      
      
   </script>
   <script type="text/javascript">
      jQuery().ready(function() {
      
        // validate form on keyup and submit
        var v = jQuery("#basicform").validate({
          rules: {
           organizationType: "required",
            userName: {
              required: true,
              minlength: 2,
              maxlength: 16
            },
            emailId: {
              required: true,
              minlength: 2,
              email: true,
              maxlength: 100,
            },
            password: {
              required: true,
              minlength: 6,
              maxlength: 15,
            },
            cpassword: {
              required: true,
              minlength: 6,
              equalTo: "#password",
            },
            organizationName: {
              required: true,
              minlength: 6,
              maxlength: 15,
            },
            location: {
              required: true,
              minlength: 6,
              maxlength: 15,
            },
            imoNo: {
              required: true,
              minlength: 6,
              maxlength: 15,
            },
            portName: {
              required: true,           
            },
            addressLine1: {
              required: true,
              minlength: 6,
              maxlength: 100,
            },
            city: {
              required: true,
              minlength: 3,
              maxlength: 25,
            },
            state: {
              required: true,
              minlength: 3,
              maxlength: 50,
            },
            country: {
              required: true,
              minlength: 3,
              maxlength: 50,
            },
            pincode: {
              required: true,
              minlength: 3,
              maxlength: 8,
            },
             agree: "required",
      
          },
          errorElement: "span",
          errorClass: "error",
        });
      
        $(".open1").click(function() {
          if (v.form()) {
            $(".frm").hide("fast");
            $("#sf2").fadeIn("slow");
          }
        });
      /*
        $(".open2").click(function() {
          if (v.form()) {
            $(".frm").hide("fast");
            $("#sf3").show("slow");
          }
        });*/
        
        $(".open2").click(function() {
          if (v.form()) {
            $("#loader").show();
           // var data = $("#basicform").serialize();
var data={
        "userData":{
        "userName": $('#userName').val(),
        "emailId":$('#emailId').val(),
        "password":$('#password').val(),
        "subscriptionId":$('#subscriptionId').val(),
        "organizationType":$('#organizationType').val()
        },
        "organizationData":{
        "organizationName":$('#organizationName').val(),
        "location": $('#location').val(),
        "imoNo": $('#imoNo').val(),
        "portId": $('#portId').val(),
        "portName": $('#portName').val(),
        "addressLine1": $('#addressLine1').val(),
        "addressLine2": $('#addressLine2').val(),
        "city": $('#city').val(),
        "state": $('#state').val(),
        "country": $('#country').val(),
        "pincode": $('#pincode').val(),
        "organizationType":$('#organizationType').val()
        }
};
           // console.log(data);       
            var url='/api/createAdminOrg';
            $.ajax({
                cache: false,
                type : 'POST',
                url  : url,
                data : data,
                dataType:"json",
                beforeSend: function()
                {
                    $("#error").fadeOut();
                    $("#btn-submit").html('<span class="glyphicon glyphicon-transfer"></span>   sending ...');
                },
                success :  function(result)
                {
                  $("#loader").hide(); 
                      if(result.status == 'Success'){ 
                                                   
                      
                      //  $.session.set("organizationType", result.data.organizationType);                                     
                        $('#smsg').html(result.status);
                        $('#fmsg').addClass('hidden');   
                        $('#smsg').removeClass('hidden'); 
                        window.location.href = "login";
                      }
                      else{
                        $('#smsg').addClass('hidden'); 
                        $('#fmsg').removeClass('hidden');  
                        $('#fmsg').html(result.Message);  
                      }             
                }
            });
            return false;
           /*  setTimeout(function(){
               $("#basicform").html('<h2>Thanks for your time.</h2>');
             }, 1000);
            return false;*/
          }
        });
        
        $(".back2").click(function() {
          $(".frm").hide("fast");
          $("#sf1").fadeIn("slow");
        });
      /*
        $(".back3").click(function() {
          $(".frm").hide("fast");
          $("#sf2").show("slow");
        });*/
      
      });
   </script>
</html>